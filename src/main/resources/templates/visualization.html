<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DSA Visualizer</title>

<link rel="stylesheet" href="/css/style.css">

<style>
.container{width:90%;margin:auto;}
.card{margin:40px 0;padding:25px;background:#f8fafc;border-radius:12px;}
canvas{border:1px dashed #cbd5e1;margin-top:15px;}
</style>
</head>

<body>

<div class="navbar">
<h2>Data Structures Lab</h2>
<a href="/topics">Back to Topics</a>
</div>

<div class="container">

<!-- ================= ARRAY ================= -->
<div class="card">
<h2>Array</h2>
<div id="arr-container"></div>
</div>

<!-- ================= STACK ================= -->
<div class="card">
<h2>Stack</h2>
<div id="stack-container"></div>
</div>

<!-- ================= QUEUE ================= -->
<div class="card">
<h2>Queue</h2>
<div id="queue-container"></div>
</div>

<!-- ================= TREE ================= -->
<div class="card">
<h2>Binary Search Tree</h2>

<input id="treeValue" type="number" placeholder="Value">
<button onclick="treeInsert()">Insert</button>
<button onclick="treeClear()">Clear</button>

<canvas id="treeCanvas" width="800" height="300"></canvas>
</div>

<!-- ================= GRAPH ================= -->
<div class="card">
<h2>Graph Visualizer</h2>

<input id="graphU" placeholder="Node A">
<input id="graphV" placeholder="Node B">
<button onclick="graphAddEdge()">Connect</button>
<button onclick="graphClear()">Clear</button>

<canvas id="graphCanvas" width="800" height="300"></canvas>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

/* ================= TREE ================= */

class Node{
constructor(v){this.val=v;this.left=null;this.right=null;this.x=0;this.y=0;}
}

let root=new Node(50);
root.left=new Node(30);
root.right=new Node(70);

const canvas=document.getElementById("treeCanvas");
const ctx=canvas.getContext("2d");

function layout(n,x,y,off){
if(!n)return;
n.x=x;n.y=y;
layout(n.left,x-off,y+60,off/2);
layout(n.right,x+off,y+60,off/2);
}

function draw(n){
if(!n)return;

if(n.left){
ctx.beginPath();
ctx.moveTo(n.x,n.y);
ctx.lineTo(n.left.x,n.left.y);
ctx.stroke();
draw(n.left);
}
if(n.right){
ctx.beginPath();
ctx.moveTo(n.x,n.y);
ctx.lineTo(n.right.x,n.right.y);
ctx.stroke();
draw(n.right);
}

ctx.beginPath();
ctx.arc(n.x,n.y,18,0,Math.PI*2);
ctx.fillStyle="white";
ctx.fill();
ctx.stroke();
ctx.fillStyle="black";
ctx.textAlign="center";
ctx.textBaseline="middle";
ctx.fillText(n.val,n.x,n.y);
}

function renderTree(){
ctx.clearRect(0,0,canvas.width,canvas.height);
layout(root,canvas.width/2,40,canvas.width/4);
draw(root);
}

window.treeInsert=function(){
const v=parseInt(treeValue.value);
if(isNaN(v))return;

let cur=root;
while(true){
if(v<cur.val){
if(!cur.left){cur.left=new Node(v);break;}
cur=cur.left;
}else{
if(!cur.right){cur.right=new Node(v);break;}
cur=cur.right;
}
}
renderTree();
}

window.treeClear=function(){
root=null;
ctx.clearRect(0,0,canvas.width,canvas.height);
}

renderTree();

/* ================= GRAPH ================= */

const gCanvas=document.getElementById("graphCanvas");
const gCtx=gCanvas.getContext("2d");

let nodes=[];
let edges=[];
let nextId=0;

gCanvas.addEventListener("click",(e)=>{
const rect=gCanvas.getBoundingClientRect();
nodes.push({
id:nextId++,
x:e.clientX-rect.left,
y:e.clientY-rect.top
});
renderGraph();
});

window.graphAddEdge=function(){
const u=parseInt(graphU.value);
const v=parseInt(graphV.value);
edges.push({u,v});
renderGraph();
}

function renderGraph(){
gCtx.clearRect(0,0,gCanvas.width,gCanvas.height);

edges.forEach(e=>{
const a=nodes.find(n=>n.id===e.u);
const b=nodes.find(n=>n.id===e.v);
if(!a||!b)return;
gCtx.beginPath();
gCtx.moveTo(a.x,a.y);
gCtx.lineTo(b.x,b.y);
gCtx.stroke();
});

nodes.forEach(n=>{
gCtx.beginPath();
gCtx.arc(n.x,n.y,18,0,Math.PI*2);
gCtx.fillStyle="white";
gCtx.fill();
gCtx.stroke();
gCtx.fillStyle="black";
gCtx.fillText(n.id,n.x,n.y);
});
}

window.graphClear=function(){
nodes=[];
edges=[];
renderGraph();
}

});
</script>

</body>
</html>